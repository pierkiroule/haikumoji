import{r as c,j as e,m as d,G as k,H as S,d as v,I as q,c as T,o as A,g as $,q as M,J as E}from"./index-BBdapSLE.js";import{S as C,E as I}from"./SelectionPanel-CaPdFs7Z.js";import{A as N}from"./index-CqGXxBgE.js";function O({currentStep:n=1,steps:t=[],onStepClick:a,className:h=""}){const[i,m]=c.useState(n);return e.jsxs("div",{className:`space-y-4 ${h}`,children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex items-center justify-between",children:t.map((l,u)=>{const x=u+1,p=x<n,o=x===n,r=x>n;return e.jsxs("div",{className:"flex-1 relative",children:[u>0&&e.jsx("div",{className:"absolute left-0 top-5 right-1/2 h-0.5 -translate-x-full",children:e.jsx("div",{className:`h-full transition-all duration-500 ${p||o?"bg-gradient-to-r from-emerald-500 to-emerald-400":"bg-slate-200"}`})}),e.jsxs(d.button,{onClick:()=>{m(x),a==null||a(x)},disabled:r,className:`relative z-10 flex flex-col items-center gap-2 w-full group ${r?"cursor-not-allowed":"cursor-pointer"}`,whileHover:r?{}:{scale:1.05},whileTap:r?{}:{scale:.98},children:[e.jsx(d.div,{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm shadow-lg transition-all duration-300 ${p?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white":o?"bg-gradient-to-br from-cyan-500 to-blue-500 text-white ring-4 ring-cyan-200":"bg-slate-200 text-slate-400"}`,animate:o?{boxShadow:["0 4px 6px rgba(6, 182, 212, 0.3)","0 8px 16px rgba(6, 182, 212, 0.5)","0 4px 6px rgba(6, 182, 212, 0.3)"]}:{},transition:{duration:2,repeat:1/0},children:p?"âœ“":x}),e.jsx("div",{className:`text-2xl transition-transform duration-300 ${o?"scale-110":""}`,children:l.icon}),e.jsx("div",{className:`text-xs font-medium text-center transition-colors duration-300 ${p||o?"text-slate-900":"text-slate-400"}`,children:l.title})]})]},l.id)})})}),e.jsx(N,{mode:"wait",children:e.jsx(d.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"rounded-2xl bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 p-6 shadow-lg",children:t[i-1]&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-3xl",children:t[i-1].icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-cyan-600 font-medium",children:["Ã‰tape ",i,"/",t.length]}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t[i-1].title})]})]}),e.jsx("p",{className:"text-slate-700 leading-relaxed mb-4",children:t[i-1].description}),t[i-1].tips&&e.jsxs("div",{className:"rounded-xl bg-white/60 border border-cyan-200 p-4",children:[e.jsx("div",{className:"text-sm font-medium text-cyan-700 mb-2",children:"ðŸ’¡ Astuce"}),e.jsx("p",{className:"text-sm text-slate-600",children:t[i-1].tips})]})]})},i)})]})}function L({value:n=[],onChange:t,placeholder:a="Ajouter des mots-clÃ©s",maxTags:h=6,className:i=""}){const[m,l]=c.useState(""),[u,x]=c.useState(!1),[p,o]=c.useState([]),r=Array.isArray(n)?n:[],f=r.length<h;c.useEffect(()=>{if(!m.trim()){o([]);return}o(k(m,6))},[m]);const y=s=>{if(!f)return;const j=S(s);j&&(r.includes(j)||(t==null||t([...r,j]),l(""),o([])))},b=s=>{t==null||t(r.filter(j=>j!==s))},g=s=>{s.key==="Enter"||s.key===","?(s.preventDefault(),y(m)):s.key==="Backspace"&&!m&&r.length&&b(r[r.length-1])};return e.jsxs("div",{className:`rounded-2xl bg-white text-slate-900 border border-slate-200 p-3 ${i}`,children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.map(s=>e.jsxs(d.span,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-full bg-gradient-to-r from-emerald-50 to-cyan-50 border border-emerald-200 text-emerald-700 text-sm",children:["#",s,e.jsx("button",{onClick:()=>b(s),className:"text-emerald-700/70 hover:text-emerald-900 ml-1",children:"Ã—"})]},s)),f&&e.jsxs("div",{className:"relative flex-1 min-w-[120px]",children:[e.jsx("input",{value:m,onChange:s=>l(s.target.value),onKeyDown:g,onFocus:()=>x(!0),onBlur:()=>setTimeout(()=>x(!1),150),placeholder:a,className:"w-full px-3 py-1.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),e.jsx(N,{children:u&&p.length>0&&e.jsx(d.ul,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},className:"absolute z-10 mt-1 left-0 right-0 rounded-xl bg-white border border-slate-200 shadow-lg overflow-hidden",children:p.map(s=>e.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-slate-50 cursor-pointer",onMouseDown:j=>j.preventDefault(),onClick:()=>y(s.label),children:["#",s.label]},s.id))})})]})]}),!f&&e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Limite de ",h," tags atteinte."]})]})}function F({emojis:n=[],size:t=120,className:a=""}){const h=Array.isArray(n)?n.slice(0,3):[],i=c.useMemo(()=>{const l=t/2-Math.max(18,Math.round(t*.12)),u=t/2,x=t/2;return[270,150,30].map(o=>{const r=o*Math.PI/180;return{x:u+l*Math.cos(r),y:x+l*Math.sin(r)}})},[t]),m=Math.max(18,Math.round(t*.22));return e.jsxs("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,className:a,children:[e.jsx("polygon",{points:i.map(l=>`${l.x},${l.y}`).join(" "),fill:"none",stroke:"#06b6d4",strokeWidth:Math.max(2,Math.round(t*.02)),strokeOpacity:.5}),i.map((l,u)=>e.jsxs("g",{children:[e.jsx("circle",{cx:l.x,cy:l.y,r:Math.max(10,Math.round(t*.06)),fill:"#10b98120",stroke:"#10b981",strokeWidth:1.5}),e.jsx("text",{x:l.x,y:l.y+m*.35,fontSize:m,textAnchor:"middle",children:h[u]||"â—‹"})]},u))]})}function D({item:n}){return e.jsx(d.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"rounded-2xl bg-white text-slate-900 shadow-card hover:shadow-card-hover p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{emojis:n.emojis,size:84}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-slate-500",children:["â€” ",n.author||"Anonyme"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(n.tags||[]).map(t=>e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200 text-xs",children:["#",t]},t))})]})]})})}function H({className:n="",refreshKey:t=0}){const[a,h]=c.useState([]);return c.useEffect(()=>{v(),h(q())},[t]),e.jsxs("div",{className:`space-y-3 ${n}`,children:[a.map(i=>e.jsx(D,{item:i},i.id)),a.length===0&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center text-slate-500 py-10",children:"Aucun onimoji pour le moment."})]})}function V(){const[n,t]=c.useState({occurrences:[],pairs:[],triples:[]}),[a,h]=c.useState([]),[i,m]=c.useState(null),[l,u]=c.useState([]),[x,p]=c.useState(0),o=T();c.useEffect(()=>{v(),t(A()),m($())},[]);const r=g=>{i&&h(s=>s.includes(g)?s.filter(w=>w!==g):s.length>=3?s:[...s,g])},f=()=>{a.length===3&&(M(a),o("/lune"))},y=()=>{if(!(!i||a.length!==3))try{E({emojis:a,tags:l,author:i.name,authorId:i.id}),u([]),p(g=>g+1)}catch{}};c.useEffect(()=>{i||o("/voyage/inuit")},[i,o]);const b=[{id:"select",icon:"âœ¨",title:"Choisir 3 Ã©mojis",description:"SÃ©lectionnez 3 Ã©mojis qui rÃ©sonnent avec votre Ã©tat onirique du moment. Ces symboles cosmiques formeront la base de votre rÃªve.",tips:"Cliquez sur les Ã©mojis dans le rÃ©seau ci-dessous. Les Ã©mojis sÃ©lectionnÃ©s apparaÃ®tront en vert brillant avec un halo lumineux."},{id:"lune",icon:"ðŸŒ™",title:"CrÃ©er votre haÃ¯ku",description:"Votre trio d'Ã©mojis gÃ©nÃ©rera un haÃ¯ku unique inspirÃ© par la sagesse inuite et la poÃ©sie onirique.",tips:"Vous pourrez regÃ©nÃ©rer le texte autant de fois que vous le souhaitez jusqu'Ã  trouver celui qui vous parle."},{id:"guardian",icon:"âœ§",title:"Rencontrer le gardien",description:"Un gardien onimoji inuit (Sila, Sedna, Nanook...) vous accueillera pour un rituel d'apaisement.",tips:"Le gardien est choisi en fonction des Ã©mojis que vous avez sÃ©lectionnÃ©s et de la lune en cours."}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-2xl glass-strong border border-white/20 shadow-card p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 text-8xl opacity-10",children:"ðŸš€"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"inline-block px-4 py-2 rounded-full bg-gradient-to-r from-aurora-blue/20 to-aurora-cyan/20 border border-white/10 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-white",children:"ðŸŒŒ Navette Cosmoniris"})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-3",children:"Hublot Cosmoji"}),e.jsxs("p",{className:"text-slate-300 text-sm leading-relaxed mb-4",children:["ðŸŒ™ Bienvenue Ã  bord, ",(i==null?void 0:i.name)||"Voyageur"," ! Le voyage Inuit se dÃ©roule en 12 lunes. Ã€ chaque lune, vous suivrez ce parcours en 3 Ã©tapes pour cultiver votre jardin onirique."]})]})]}),e.jsx(d.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(O,{currentStep:1,steps:b})}),e.jsx(d.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(C,{selected:a,maxSelection:3,onClear:()=>h([])})}),e.jsxs(d.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"rounded-2xl bg-white text-slate-900 shadow-card-hover p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-1",children:"RÃ©seau Cosmoji"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Cliquez sur 3 Ã©mojis. Taille = popularitÃ© â€¢ Liens = associations frÃ©quentes"})]})}),e.jsx(I,{stats:n,selectable:!0,selected:a,onToggle:r,maxNodes:30,maxLinks:200,glow:!0,getNodeColor:(g,s)=>({fill:s?"#10b981":"#0ea5e9",stroke:s?"#059669":"#0284c7",fillOpacity:s?.85:.12,strokeOpacity:s?1:.45})})]}),e.jsxs("div",{className:"flex flex-col gap-4 pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-600",children:a.length===0?e.jsx("span",{className:"text-slate-400 italic",children:"Aucun Ã©moji sÃ©lectionnÃ©"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:"Votre sÃ©lection :"})," ",e.jsx("span",{className:"font-mono text-2xl ml-2",children:a.join(" ")}),e.jsxs("span",{className:"ml-2 text-xs text-slate-500",children:["(",a.length,"/3)"]})]})}),e.jsx(L,{value:l,onChange:u,placeholder:"Ajouter vos mots-clÃ©s (optionnel)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(d.button,{whileHover:a.length===3?{scale:1.02}:{},whileTap:a.length===3?{scale:.98}:{},onClick:y,disabled:a.length!==3,className:`flex-1 rounded-xl px-6 py-3 font-semibold transition-all duration-300 ${a.length===3?"bg-gradient-to-r from-emerald-600 to-emerald-500 text-white shadow-lg":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:"âœ¨ Ã‰mettre mon onimoji"}),e.jsx(d.button,{whileHover:a.length===3?{scale:1.02}:{},whileTap:a.length===3?{scale:.98}:{},onClick:f,disabled:a.length!==3,className:`flex-1 rounded-xl px-6 py-3 font-semibold transition-all duration-300 ${a.length===3?"bg-gradient-to-r from-midnight-400 to-midnight-500 text-white shadow-lg":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:"ðŸŒ™ Continuer vers la Lune"})]})]})]}),e.jsxs(d.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},className:"rounded-2xl glass-strong border border-white/20 p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Flux des onimojis"}),e.jsx(H,{refreshKey:x})]})]})}export{V as default};
