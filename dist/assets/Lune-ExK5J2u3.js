import{r as i,u as j,s as N,n as w,k as L,b as v,j as e,y as S,p as $}from"./index-DW_y-zBj.js";const q=["Sous la lune pâle","Dans le grand silence","Au bord de la glace","Entre deux marées","Sous les aurores","Près du souffle froid"],y=["un chant s’élève doucement","la mémoire se déplie","un regard cherche le nord","la patience apprend à voir","une étincelle réchauffe","la nuit écoute nos pas"],M=["le rêve tient dans la main","les baleines racontent","la banquise se souvient","les étoiles se rapprochent","le corbeau nous apprend","le cercle se referme"],p={openings:q,middles:y,closings:M},k={1:{titre:"La Lune du Souffle",ressource:"Le mythe du Narval et le souffle marin."},2:{titre:"La Lune du Silence",ressource:"Le rêve du corbeau et la patience du froid."},3:{titre:"La Lune des Aurores",ressource:"Les rubans verts et pourpres qui dansent au nord."},4:{titre:"La Lune des Glaces",ressource:"La marche sur la banquise et la sagesse des traces."},5:{titre:"La Lune des Marées",ressource:"Les esprits des eaux et la respiration des rivages."},6:{titre:"La Lune des Animaux",ressource:"La baleine qui chante, le phoque qui écoute, le renard qui guette."},7:{titre:"La Lune des Feux",ressource:"Le foyer, la braise qui parle et la mémoire des anciens."},8:{titre:"La Lune des Oiseaux",ressource:"Les migrations, les plumes, et la carte secrète du ciel."},9:{titre:"La Lune des Reflets",ressource:"Le miroir de la glace, les eaux sombres, les doubles rêves."},10:{titre:"La Lune des Chemins",ressource:"Le traîneau, la trace, et le fil invisible de l’entraide."},11:{titre:"La Lune de l’Écoute",ressource:"La parole des pierres, les murmures du vent, le pacte du silence."},12:{titre:"La Lune du Retour",ressource:"Le cercle se referme : partager, transmettre, préserver l’onidiversité."}};function g(n,l){const t=o=>o[Math.floor(Math.random()*o.length)],[d,u,r]=(n||[]).slice(0,3),s=`${t(l.openings)} — ${d||""}`.trim(),m=`${t(l.middles)} — ${u||""}`.trim(),x=`${t(l.closings)} — ${r||""}`.trim();return`${s}
${m}
${x}`}function R(){const[n,l]=i.useState(1),[t,d]=i.useState([]),[u,r]=i.useState(""),[s,m]=i.useState(null),x=j();i.useEffect(()=>{N();const a=w();l(a);const c=L();d(c);const h=v();m(h),r(h?g(c,p):"")},[]);const o=i.useMemo(()=>k[String(n)]||{titre:`Lune ${n}`,ressource:""},[n]),b=()=>{const a=v();if(!a){alert("Inscription locale requise pour sauvegarder un rêve.");return}S({moon:n,emojis:t,text:u,author:a.name,authorId:a.id}),alert("Rêve sauvegardé dans la mémoire locale.")},f=()=>{const a=$();l(a);const c=L();r(s?g(c,p):"")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{className:"rounded-2xl bg-white text-slate-900 shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-medium",children:o.titre}),e.jsx("p",{className:"text-slate-600 mt-1 text-sm",children:o.ressource}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:()=>x("/guardian"),className:"rounded-xl bg-indigo-600 text-white px-3 py-2 text-sm hover:bg-indigo-700",children:"Rencontrer le gardien ✧"})})]}),e.jsxs("section",{className:"rounded-2xl bg-white text-slate-900 shadow p-6",children:[e.jsx("div",{className:"text-3xl select-none",children:t.join(" ")||"—"}),!s&&e.jsx("div",{className:"mt-3 rounded-xl bg-indigo-50 border border-indigo-200 text-indigo-800 p-3 text-sm",children:"Inscrivez-vous localement pour générer et sauvegarder un rêve."}),e.jsx("pre",{className:"mt-3 whitespace-pre-wrap leading-relaxed text-slate-800",children:u}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{if(!s){alert("Inscription locale requise.");return}r(g(t,p))},disabled:!s,className:`rounded-xl px-3 py-2 ${s?"bg-slate-900 text-white":"bg-slate-200 text-slate-500 cursor-not-allowed"}`,children:"Regénérer"}),e.jsx("button",{onClick:b,disabled:!s,className:`rounded-xl px-3 py-2 ${s?"bg-emerald-600 text-white":"bg-slate-200 text-slate-500 cursor-not-allowed"}`,children:"Sauvegarder"}),e.jsx("button",{onClick:f,className:"rounded-xl bg-indigo-600 text-white px-3 py-2",children:"Lune suivante →"})]})]})]})}export{R as default};
