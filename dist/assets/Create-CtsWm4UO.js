import{M as H,r as a,A as O,j as s,u as U,s as _,g as D,a as J,b as z,c as W,d as G}from"./index-A1U1SQO0.js";import{a as Z,s as q,u as X,b as K,m as V}from"./proxy-fKwwuVZM.js";import{P as Q}from"./PantheonModal-BgnZkz0Y.js";function Y(e){e.values.forEach(t=>t.stop())}function R(e,t){[...t].reverse().forEach(d=>{const m=e.getVariant(d);m&&q(e,m),e.variantChildren&&e.variantChildren.forEach(c=>{R(c,t)})})}function ee(e,t){if(Array.isArray(t))return R(e,t);if(typeof t=="string")return R(e,[t]);q(e,t)}function te(){const e=new Set,t={subscribe(n){return e.add(n),()=>void e.delete(n)},start(n,d){const m=[];return e.forEach(c=>{m.push(Z(c,n,{transitionOverride:d}))}),Promise.all(m)},set(n){return e.forEach(d=>{ee(d,n)})},stop(){e.forEach(n=>{Y(n)})},mount(){return()=>{t.stop()}}};return t}function se(){const e=X(te);return K(e.mount,[]),e}const ne={"ðŸŒ¬ï¸":["vent","souffle","brise"],"â„ï¸":["glace","givre","hiver"],"ðŸ‹":["baleine","chant","cÃ©tacÃ©"],"ðŸŒŠ":["vague","marÃ©e","ocÃ©an"],"ðŸ”¥":["feu","braise","ardeur"],"ðŸŒ™":["lune","bleue","nuit"],"ðŸ›¶":["canoÃ«","kayak","berge"],"ðŸŒŒ":["voie lactÃ©e","galaxie","cosmos"],"ðŸ§Š":["banquise","glacon","froid"],"ðŸŒˆ":["arc","pluie","couleurs"],"ðŸš":["coquillage","Ã©coute","rivage"],"ðŸª¶":["plume","lÃ©ger","oiseau"],"ðŸŒž":["soleil","midi","chaleur"],"ðŸ’§":["goutte","rosÃ©e","source"],"ðŸŒ¿":["herbe","forÃªt","mousse"],"ðŸ‚":["feuille","automne","bruit sec"],"ðŸŒ‘":["ombre","nouvelle lune","silence"],"â˜ï¸":["nuage","voile","brume"],"ðŸ¦­":["phoque","Ã®le","arctique"],"ðŸŒ•":["pleine lune","argent","ronde"],"ðŸŒ ":["Ã©toile filante","souhait","tracÃ©"],"ðŸŒ§ï¸":["averse","rumeur","ruissellement"],"ðŸŽµ":["chant","mÃ©lodie","tempo"],"ðŸªž":["miroir","reflet","lueur"],"ðŸª·":["lotus","Ã©tang","sÃ©rÃ©nitÃ©"],"ðŸ’«":["Ã©tincelle","vertige","poussiÃ¨re dâ€™Ã©toile"]},re=["sous","dans","sur","vers","prÃ¨s de","avec"],ae=["chante","tombe","respire","murmure","gronde","luit","s'Ã©veille","s'endort"],oe=["doucement","lentement","encore","dÃ©jÃ ","toujours"],le=["â€”","â€¦",":"];function E(e){return e[Math.floor(Math.random()*e.length)]}function ie(e){const t=(e||"").trim().toLowerCase();return/^[aeiouyÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã®Ã¯Ã´Ã¶Ã¹Ã»Ã¼Å“h]/.test(t)}function ce(e){const t=(e||"").trim().toLowerCase();return/e$/.test(t)||/Ã©e$/.test(t)||/ette$/.test(t)}function I(e){const t=(e||"").trim();if(t.length===0||/^(le|la|les|un|une|des|du|de la|de lâ€™|de l'|lâ€™|l')\s/i.test(t))return t;if(ie(t))return`lâ€™${t}`;const n=ce(t);return`${E(n?["la","une","cette"]:["le","un","ce"])} ${t}`}function S(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function w(e,t){const n=e;switch(t){case 0:return S(I(n));case 1:return`${S(E(re))} ${I(n)}`;case 2:return`${S(E(ae))} ${I(n)}`;case 3:return`${S(I(n))} ${E(oe)}`;default:return S(n)}}function P(e){const t=ne[e];return Array.isArray(t)&&t.length>0?t:["silence","nuit","vent"]}function F(e=[],t=H){const n=Array.isArray(e)?e.slice(0,3):[];if(n.length<3)return[];const[d,m,c]=n,A=P(d),j=P(m),h=P(c),o=new Set;for(;o.size<Math.min(t,8);){const i=E(A),u=E(j),f=E(h),x=Math.floor(Math.random()*5);let l,g,N;if(x===0)l=w(i,0),g=w(u,1),N=w(f,2);else if(x===1)l=w(i,0),g=w(u,3),N=w(f,0);else if(x===2){const v=E(le);l=`${w(i,0)} ${v}`,g=w(u,2),N=w(f,0)}else x===3?(l=w(i,0),g=`Entre ${I(i)} et ${I(f)}`,N=w(f,0)):(l=S(i),g=S(u),N=S(f));const C=`${l}
${g}
${N}`;o.add(C)}return Array.from(o)}const ue=400,me=36;function de(e,t,n){const[d,m]=a.useState(()=>new Array(e).fill(0).map(()=>({x:0,y:0}))),c=a.useRef(new Array(e).fill(0).map(()=>({vx:0,vy:0}))),A=a.useRef(new Array(e).fill(null).map(()=>se())),j=a.useRef(null);return a.useEffect(()=>{const h=t/2-n,o=d.map(()=>{const i=Math.random()*Math.PI*2,u=Math.sqrt(Math.random())*h;return{x:Math.cos(i)*u,y:Math.sin(i)*u}});m(o),c.current=c.current.map(()=>({vx:Math.random()*.6-.3,vy:Math.random()*.6-.3}))},[e,t]),a.useEffect(()=>{const h=t/2-n,o=.995,i=.95;let u=performance.now();const f=()=>{const x=performance.now(),l=Math.min(33,x-u)/16.67;u=x,m(g=>g.map((C,v)=>{const p=c.current[v];p.vx+=(Math.random()-.5)*.01,p.vy+=(Math.random()-.5)*.01;let $=C.x+p.vx*l,r=C.y+p.vy*l;const b=Math.hypot($,r);if(b>h){const M=$/b,y=r/b;$=M*h,r=y*h;const k=p.vx*M+p.vy*y;p.vx=(p.vx-2*k*M)*i,p.vy=(p.vy-2*k*y)*i}return p.vx*=o,p.vy*=o,{x:$,y:r}})),j.current=requestAnimationFrame(f)};return j.current=requestAnimationFrame(f),()=>cancelAnimationFrame(j.current)},[t]),{positions:d,controls:A.current}}function he({emojis:e=O,selected:t,setSelected:n,maxSelected:d=5,size:m=ue,emojiSize:c=me}){const A=a.useRef(null),{positions:j}=de(e.length,m,c),h=o=>{if(t.includes(o))n(t.filter(u=>u!==o));else{if(t.length>=d)return;n([...t,o])}};return s.jsx("div",{className:"relative mx-auto",style:{width:m,height:m},children:s.jsx("div",{ref:A,className:"w-full h-full rounded-full bg-white/70 backdrop-blur-sm shadow-inner shadow-blue-100 border border-white/60 overflow-hidden",children:e.map((o,i)=>{const u=t.includes(o),f=j[i]||{x:0,y:0},x=m/2,l={x:x+f.x-c/2,y:x+f.y-c/2};return s.jsx(V.button,{className:"absolute flex items-center justify-center select-none",style:{width:c,height:c},animate:{left:l.x,top:l.y,scale:u?1.35:1,filter:u?"drop-shadow(0 0 8px rgba(59,130,246,0.7))":"none"},transition:{type:"spring",stiffness:120,damping:16},onClick:()=>h(o),children:s.jsx("span",{className:`transition-colors ${u?"text-blue-600":"text-slate-700"}`,style:{fontSize:Math.round(c*.8)},children:o})},i)})})})}const fe=O;function ge(){const[e,t]=a.useState([]),[n,d]=a.useState(!1),[m,c]=a.useState(360),[A,j]=a.useState(36),[h,o]=a.useState(["","",""]),[i,u]=a.useState(""),[f,x]=a.useState([]),[l,g]=a.useState("select"),N=U(),C=a.useRef(null);a.useEffect(()=>{_();const r=D();r&&(t(Array.isArray(r.emojis)?r.emojis:[]),o(Array.isArray(r.lines)&&r.lines.length===3?r.lines:["","",""]));const b=()=>{const M=Math.max(320,Math.min(window.innerWidth,640)),y=Math.max(540,window.innerHeight),k=Math.round(M*.82),B=Math.round(Math.max(260,Math.min(y*.48,460))),L=Math.min(k,B),T=Math.max(28,Math.round(L*.085));c(L),j(T)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),a.useEffect(()=>{J({emojis:e,lines:h})},[e,h]),a.useEffect(()=>{if(l==="compose"){if(e.length<3){x([]);return}x(F(e.slice(0,3)))}},[l,e]);const v=e.length>=3&&e.length<=5,p=v?"Composer mon HaÃ¯ku":"Choisir 3â€“5 Ã©mojis";a.useEffect(()=>{!v&&l!=="select"&&g("select")},[v,l]),a.useEffect(()=>{l==="compose"&&setTimeout(()=>{const r=C.current||document.getElementById("compose-area");r==null||r.scrollIntoView({behavior:"smooth",block:"center"})},0)},[l]);const $=()=>{if(!v)return;const r=h.map(y=>y.trim());if(r.some(y=>y.length===0)){u("ComplÃ¨te les trois lignes avant de publier.");return}const b=z()||{name:"Anonyme",id:null},M=r.join(`
`);W({emojis:e.slice(0,5),text:M,author:b.name,authorId:b.id}),G(),N("/community")};return s.jsxs("div",{className:"min-h-screen flex flex-col",children:[s.jsxs("header",{className:"p-4 flex items-center justify-between",children:[s.jsx("div",{className:"font-medium text-slate-700",children:"HaÃ¯kuMoji"}),s.jsxs("div",{className:"text-sm text-slate-600",children:[e.length,"/5"]})]}),s.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-6 px-4",children:[s.jsxs("div",{className:"relative w-full flex items-center justify-center",children:[s.jsx(he,{emojis:fe,selected:e,setSelected:t,maxSelected:5,size:m,emojiSize:A}),s.jsx(V.button,{onClick:()=>d(!0),className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-14 h-14 rounded-full flex items-center justify-center bg-white shadow-glow border border-white/70",animate:{scale:[1,1.08,1],boxShadow:["0 0 20px rgba(59,130,246,0.25)","0 0 40px rgba(59,130,246,0.45)","0 0 20px rgba(59,130,246,0.25)"]},transition:{duration:2.4,repeat:1/0,ease:"easeInOut"},"aria-label":"Open PanthÃ©on",title:"Voir le PanthÃ©on",children:s.jsx("span",{className:"text-2xl",children:"âœ¨"})})]}),s.jsx("div",{className:"w-full max-w-sm",children:s.jsx("button",{disabled:!v,className:`w-full h-12 rounded-xl font-medium transition 
              ${v?"bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 shadow-lg shadow-blue-200":"bg-slate-200 text-slate-500 cursor-not-allowed"}`,onClick:()=>g("compose"),children:p})}),l==="compose"&&v&&s.jsxs("div",{id:"compose-area",ref:C,className:"w-full max-w-sm rounded-2xl bg-white shadow p-4 space-y-3",children:[s.jsx("div",{className:"text-lg select-none mb-1",children:e.join(" ")}),f.length>0&&s.jsxs("div",{className:"rounded-xl border border-slate-200 p-3 bg-slate-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm text-slate-600",children:["Inspiration (sÃ©quence ",e.slice(0,3).join(" "),")"]}),s.jsx("button",{onClick:()=>x(F(e.slice(0,3))),className:"text-xs px-2 py-1 rounded-lg border bg-white hover:bg-slate-100",children:"â†» Refaire"})]}),s.jsx("ul",{className:"space-y-2 max-h-56 overflow-auto pr-1",children:f.map((r,b)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("pre",{className:"flex-1 whitespace-pre-wrap text-sm text-slate-800",children:r}),s.jsx("button",{onClick:()=>o(r.split(`
`).slice(0,3)),className:"self-start text-xs px-2 py-1 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700","aria-label":"Utiliser cette suggestion",children:"Utiliser"})]},b))})]}),[0,1,2].map(r=>s.jsxs("div",{className:"space-y-1",children:[s.jsxs("label",{className:"block text-sm text-slate-600",children:["L",r+1]}),s.jsx("textarea",{value:h[r],onChange:b=>o(h.map((M,y)=>y===r?b.target.value:M)),rows:2,className:"w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300",placeholder:r===0?"5 syllabesâ€¦":r===1?"7 syllabesâ€¦":"5 syllabesâ€¦"})]},r)),i&&s.jsx("p",{className:"text-sm text-red-600",children:i}),s.jsx("button",{onClick:$,className:"w-full h-12 rounded-xl bg-emerald-600 text-white font-medium hover:bg-emerald-700 active:bg-emerald-800 transition",children:"Publier"})]})]}),s.jsxs("footer",{className:"p-4 text-center text-xs text-slate-500",children:["Prototype â€“ animations ",s.jsx("span",{className:"font-mono",children:"Framer Motion"}),", layout ",s.jsx("span",{className:"font-mono",children:"Tailwind"})]}),s.jsx(Q,{open:n,onClose:()=>d(!1)})]})}export{ge as default};
