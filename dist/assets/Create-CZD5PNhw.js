import{a as B,s as H,u as U,b as _,M as D,r as a,A as O,j as s,m as p,c as J,d as z,g as W,e as G,f as Z,h as X,i as K}from"./index-CU2UvyjV.js";import{P as Q}from"./PantheonModal-0M57FDfU.js";import"./index-D2TxTuQx.js";function Y(e){e.values.forEach(t=>t.stop())}function R(e,t){[...t].reverse().forEach(m=>{const d=e.getVariant(m);d&&H(e,d),e.variantChildren&&e.variantChildren.forEach(c=>{R(c,t)})})}function ee(e,t){if(Array.isArray(t))return R(e,t);if(typeof t=="string")return R(e,[t]);H(e,t)}function te(){const e=new Set,t={subscribe(r){return e.add(r),()=>void e.delete(r)},start(r,m){const d=[];return e.forEach(c=>{d.push(B(c,r,{transitionOverride:m}))}),Promise.all(d)},set(r){return e.forEach(m=>{ee(m,r)})},stop(){e.forEach(r=>{Y(r)})},mount(){return()=>{t.stop()}}};return t}function se(){const e=U(te);return _(e.mount,[]),e}const ne={"ðŸŒ¬ï¸":["vent","souffle","brise"],"â„ï¸":["glace","givre","hiver"],"ðŸ‹":["baleine","chant","cÃ©tacÃ©"],"ðŸŒŠ":["vague","marÃ©e","ocÃ©an"],"ðŸ”¥":["feu","braise","ardeur"],"ðŸŒ™":["lune","bleue","nuit"],"ðŸ›¶":["canoÃ«","kayak","berge"],"ðŸŒŒ":["voie lactÃ©e","galaxie","cosmos"],"ðŸ§Š":["banquise","glacon","froid"],"ðŸŒˆ":["arc","pluie","couleurs"],"ðŸš":["coquillage","Ã©coute","rivage"],"ðŸª¶":["plume","lÃ©ger","oiseau"],"ðŸŒž":["soleil","midi","chaleur"],"ðŸ’§":["goutte","rosÃ©e","source"],"ðŸŒ¿":["herbe","forÃªt","mousse"],"ðŸ‚":["feuille","automne","bruit sec"],"ðŸŒ‘":["ombre","nouvelle lune","silence"],"â˜ï¸":["nuage","voile","brume"],"ðŸ¦­":["phoque","Ã®le","arctique"],"ðŸŒ•":["pleine lune","argent","ronde"],"ðŸŒ ":["Ã©toile filante","souhait","tracÃ©"],"ðŸŒ§ï¸":["averse","rumeur","ruissellement"],"ðŸŽµ":["chant","mÃ©lodie","tempo"],"ðŸªž":["miroir","reflet","lueur"],"ðŸª·":["lotus","Ã©tang","sÃ©rÃ©nitÃ©"],"ðŸ’«":["Ã©tincelle","vertige","poussiÃ¨re dâ€™Ã©toile"]},re=["sous","dans","sur","vers","prÃ¨s de","avec"],ae=["chante","tombe","respire","murmure","gronde","luit","s'Ã©veille","s'endort"],oe=["doucement","lentement","encore","dÃ©jÃ ","toujours"],ie=["â€”","â€¦",":"];function S(e){return e[Math.floor(Math.random()*e.length)]}function le(e){const t=(e||"").trim().toLowerCase();return/^[aeiouyÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã®Ã¯Ã´Ã¶Ã¹Ã»Ã¼Å“h]/.test(t)}function ce(e){const t=(e||"").trim().toLowerCase();return/e$/.test(t)||/Ã©e$/.test(t)||/ette$/.test(t)}function k(e){const t=(e||"").trim();if(t.length===0||/^(le|la|les|un|une|des|du|de la|de lâ€™|de l'|lâ€™|l')\s/i.test(t))return t;if(le(t))return`lâ€™${t}`;const r=ce(t);return`${S(r?["la","une","cette"]:["le","un","ce"])} ${t}`}function A(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function j(e,t){const r=e;switch(t){case 0:return A(k(r));case 1:return`${A(S(re))} ${k(r)}`;case 2:return`${A(S(ae))} ${k(r)}`;case 3:return`${A(k(r))} ${S(oe)}`;default:return A(r)}}function L(e){const t=ne[e];return Array.isArray(t)&&t.length>0?t:["silence","nuit","vent"]}function F(e=[],t=D){const r=Array.isArray(e)?e.slice(0,3):[];if(r.length<3)return[];const[m,d,c]=r,C=L(m),N=L(d),h=L(c),o=new Set;for(;o.size<Math.min(t,8);){const l=S(C),u=S(N),f=S(h),g=Math.floor(Math.random()*5);let i,w,M;if(g===0)i=j(l,0),w=j(u,1),M=j(f,2);else if(g===1)i=j(l,0),w=j(u,3),M=j(f,0);else if(g===2){const y=S(ie);i=`${j(l,0)} ${y}`,w=j(u,2),M=j(f,0)}else g===3?(i=j(l,0),w=`Entre ${k(l)} et ${k(f)}`,M=j(f,0)):(i=A(l),w=A(u),M=A(f));const $=`${i}
${w}
${M}`;o.add($)}return Array.from(o)}const ue=400,de=36;function me(e,t,r){const[m,d]=a.useState(()=>new Array(e).fill(0).map(()=>({x:0,y:0}))),c=a.useRef(new Array(e).fill(0).map(()=>({vx:0,vy:0}))),C=a.useRef(new Array(e).fill(null).map(()=>se())),N=a.useRef(null);return a.useEffect(()=>{const h=t/2-r,o=m.map(()=>{const l=Math.random()*Math.PI*2,u=Math.sqrt(Math.random())*h;return{x:Math.cos(l)*u,y:Math.sin(l)*u}});d(o),c.current=c.current.map(()=>({vx:Math.random()*.6-.3,vy:Math.random()*.6-.3}))},[e,t]),a.useEffect(()=>{const h=t/2-r,o=.995,l=.95;let u=performance.now();const f=()=>{const g=performance.now(),i=Math.min(33,g-u)/16.67;u=g,d(w=>w.map(($,y)=>{const b=c.current[y];b.vx+=(Math.random()-.5)*.01,b.vy+=(Math.random()-.5)*.01;let I=$.x+b.vx*i,n=$.y+b.vy*i;const x=Math.hypot(I,n);if(x>h){const E=I/x,v=n/x;I=E*h,n=v*h;const P=b.vx*E+b.vy*v;b.vx=(b.vx-2*P*E)*l,b.vy=(b.vy-2*P*v)*l}return b.vx*=o,b.vy*=o,{x:I,y:n}})),N.current=requestAnimationFrame(f)};return N.current=requestAnimationFrame(f),()=>cancelAnimationFrame(N.current)},[t]),{positions:m,controls:C.current}}function he({emojis:e=O,selected:t,setSelected:r,maxSelected:m=5,size:d=ue,emojiSize:c=de}){const C=a.useRef(null),{positions:N}=me(e.length,d,c),h=o=>{if(t.includes(o))r(t.filter(u=>u!==o));else{if(t.length>=m)return;r([...t,o])}};return s.jsx("div",{className:"relative mx-auto",style:{width:d,height:d},children:s.jsx("div",{ref:C,className:"w-full h-full rounded-full bg-white/70 backdrop-blur-sm shadow-inner shadow-blue-100 border border-white/60 overflow-hidden",children:e.map((o,l)=>{const u=t.includes(o),f=N[l]||{x:0,y:0},g=d/2,i={x:g+f.x-c/2,y:g+f.y-c/2};return s.jsx(p.button,{className:"absolute flex items-center justify-center select-none",style:{width:c,height:c},animate:{left:i.x,top:i.y,scale:u?1.35:1,filter:u?"drop-shadow(0 0 8px rgba(59,130,246,0.7))":"none"},transition:{type:"spring",stiffness:120,damping:16},onClick:()=>h(o),children:s.jsx("span",{className:`transition-colors ${u?"text-blue-600":"text-slate-700"}`,style:{fontSize:Math.round(c*.8)},children:o})},l)})})})}const fe=O;function be(){const[e,t]=a.useState([]),[r,m]=a.useState(!1),[d,c]=a.useState(360),[C,N]=a.useState(36),[h,o]=a.useState(["","",""]),[l,u]=a.useState(""),[f,g]=a.useState([]),[i,w]=a.useState("select"),M=J(),$=a.useRef(null);a.useEffect(()=>{z();const n=W();n&&(t(Array.isArray(n.emojis)?n.emojis:[]),o(Array.isArray(n.lines)&&n.lines.length===3?n.lines:["","",""]));const x=()=>{const E=Math.max(320,Math.min(window.innerWidth,640)),v=Math.max(540,window.innerHeight),P=Math.round(E*.82),V=Math.round(Math.max(260,Math.min(v*.48,460))),T=Math.min(P,V),q=Math.max(28,Math.round(T*.085));c(T),N(q)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),a.useEffect(()=>{G({emojis:e,lines:h})},[e,h]),a.useEffect(()=>{if(i==="compose"){if(e.length<3){g([]);return}g(F(e.slice(0,3)))}},[i,e]);const y=e.length>=3&&e.length<=5,b=y?"Composer mon HaÃ¯ku":"Choisir 3â€“5 Ã©mojis";a.useEffect(()=>{!y&&i!=="select"&&w("select")},[y,i]),a.useEffect(()=>{i==="compose"&&setTimeout(()=>{const n=$.current||document.getElementById("compose-area");n==null||n.scrollIntoView({behavior:"smooth",block:"center"})},0)},[i]);const I=()=>{if(!y)return;const n=h.map(v=>v.trim());if(n.some(v=>v.length===0)){u("ComplÃ¨te les trois lignes avant de publier.");return}const x=Z()||{name:"Anonyme",id:null},E=n.join(`
`);X({emojis:e.slice(0,5),text:E,author:x.name,authorId:x.id}),K(),M("/community")};return s.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-midnight-900 to-midnight-800",children:[s.jsxs(p.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"p-6 flex items-center justify-between glass-strong border-b border-white/10",children:[s.jsxs("div",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:"âœ¨"}),s.jsx("span",{children:"HaÃ¯kuMoji"})]}),s.jsxs("div",{className:"px-3 py-1.5 rounded-full glass border border-white/20 text-sm font-medium text-white",children:[e.length,"/5 Ã©mojis"]})]}),s.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-8 px-4 py-8",children:[s.jsxs(p.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"relative w-full flex items-center justify-center",children:[s.jsx(he,{emojis:fe,selected:e,setSelected:t,maxSelected:5,size:d,emojiSize:C}),s.jsx(p.button,{onClick:()=>m(!0),className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full flex items-center justify-center bg-gradient-to-br from-white to-slate-100 text-slate-900 shadow-glow-lg border-2 border-white/70 hover:scale-110 transition-transform duration-300",animate:{scale:[1,1.08,1],boxShadow:["0 0 20px rgba(59,130,246,0.25), 0 0 40px rgba(147,51,234,0.15)","0 0 40px rgba(59,130,246,0.45), 0 0 60px rgba(147,51,234,0.25)","0 0 20px rgba(59,130,246,0.25), 0 0 40px rgba(147,51,234,0.15)"]},transition:{duration:2.4,repeat:1/0,ease:"easeInOut"},"aria-label":"Open PanthÃ©on",title:"Voir le PanthÃ©on",children:s.jsx("span",{className:"text-3xl",children:"âœ¨"})})]}),s.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"w-full max-w-sm",children:s.jsx(p.button,{disabled:!y,whileHover:y?{scale:1.02}:{},whileTap:y?{scale:.98}:{},className:`w-full h-14 rounded-2xl font-semibold transition-all duration-300 ${y?"bg-gradient-to-r from-midnight-400 to-midnight-500 text-white hover:shadow-aurora shadow-lg":"glass text-slate-400 cursor-not-allowed border border-white/10"}`,onClick:()=>w("compose"),children:b})}),i==="compose"&&y&&s.jsxs(p.div,{id:"compose-area",ref:$,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4},className:"w-full max-w-sm rounded-2xl bg-white text-slate-900 shadow-card-hover p-6 space-y-4",children:[s.jsx("div",{className:"text-3xl select-none mb-2 text-center",children:e.join(" ")}),f.length>0&&s.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},className:"rounded-xl border border-slate-200 p-4 bg-gradient-to-br from-slate-50 to-white",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:"ðŸ’¡ Inspiration"}),s.jsx(p.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(F(e.slice(0,3))),className:"text-xs px-3 py-1.5 rounded-lg border border-slate-300 bg-white text-slate-900 hover:bg-slate-50 font-medium shadow-sm",children:"â†» Refaire"})]}),s.jsx("ul",{className:"space-y-2 max-h-56 overflow-auto pr-1",children:f.map((n,x)=>s.jsxs(p.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:x*.1},className:"flex items-start gap-2 p-3 rounded-lg bg-white border border-slate-200 hover:border-slate-300 transition-colors",children:[s.jsx("pre",{className:"flex-1 whitespace-pre-wrap text-sm text-slate-800 leading-relaxed",children:n}),s.jsx(p.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o(n.split(`
`).slice(0,3)),className:"self-start text-xs px-3 py-1.5 rounded-lg bg-gradient-to-r from-emerald-600 to-emerald-500 text-white hover:from-emerald-700 hover:to-emerald-600 font-medium shadow-sm","aria-label":"Utiliser cette suggestion",children:"Utiliser"})]},x))})]}),[0,1,2].map(n=>s.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2+n*.1},className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Ligne ",n+1," ",s.jsxs("span",{className:"text-slate-400 font-normal",children:["(",n===1?"7":"5"," syllabes)"]})]}),s.jsx("textarea",{value:h[n],onChange:x=>o(h.map((E,v)=>v===n?x.target.value:E)),rows:2,className:"w-full rounded-xl border-2 border-slate-200 px-4 py-3 focus:outline-none focus:border-midnight-400 focus:ring-4 focus:ring-midnight-400/20 transition-all duration-300",placeholder:n===0?"Un rÃªve commence...":n===1?"L'Ã©motion s'Ã©veille...":"Le voyage continue..."})]},n)),l&&s.jsx(p.p,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:l}),s.jsx(p.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:I,className:"w-full h-14 rounded-xl bg-gradient-to-r from-emerald-600 to-emerald-500 text-white font-semibold hover:from-emerald-700 hover:to-emerald-600 shadow-lg hover:shadow-xl transition-all duration-300",children:"âœ¨ Publier mon haÃ¯ku"})]})]}),s.jsxs(p.footer,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"p-4 text-center text-xs text-slate-400 glass-strong border-t border-white/10",children:["Prototype â€“ animations ",s.jsx("span",{className:"font-mono text-slate-300",children:"Framer Motion"}),", layout ",s.jsx("span",{className:"font-mono text-slate-300",children:"Tailwind"})]}),s.jsx(Q,{open:r,onClose:()=>m(!1)})]})}export{be as default};
