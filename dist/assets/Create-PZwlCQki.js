import{a as V,s as F,u as U,b as z,M as D,r as o,A as q,j as s,m as p,c as _,d as J,e as G,f as W,g as Z,h as X,i as K}from"./index-BBdapSLE.js";import{A as Q}from"./index-CqGXxBgE.js";import{P as Y}from"./PantheonModal-ptEOK_sE.js";function ee(e){e.values.forEach(t=>t.stop())}function L(e,t){[...t].reverse().forEach(h=>{const c=e.getVariant(h);c&&F(e,c),e.variantChildren&&e.variantChildren.forEach(d=>{L(d,t)})})}function te(e,t){if(Array.isArray(t))return L(e,t);if(typeof t=="string")return L(e,[t]);F(e,t)}function se(){const e=new Set,t={subscribe(r){return e.add(r),()=>void e.delete(r)},start(r,h){const c=[];return e.forEach(d=>{c.push(V(d,r,{transitionOverride:h}))}),Promise.all(c)},set(r){return e.forEach(h=>{te(h,r)})},stop(){e.forEach(r=>{ee(r)})},mount(){return()=>{t.stop()}}};return t}function ne(){const e=U(se);return z(e.mount,[]),e}const re={"🌬️":["vent","souffle","brise"],"❄️":["glace","givre","hiver"],"🐋":["baleine","chant","cétacé"],"🌊":["vague","marée","océan"],"🔥":["feu","braise","ardeur"],"🌙":["lune","bleue","nuit"],"🛶":["canoë","kayak","berge"],"🌌":["voie lactée","galaxie","cosmos"],"🧊":["banquise","glacon","froid"],"🌈":["arc","pluie","couleurs"],"🐚":["coquillage","écoute","rivage"],"🪶":["plume","léger","oiseau"],"🌞":["soleil","midi","chaleur"],"💧":["goutte","rosée","source"],"🌿":["herbe","forêt","mousse"],"🍂":["feuille","automne","bruit sec"],"🌑":["ombre","nouvelle lune","silence"],"☁️":["nuage","voile","brume"],"🦭":["phoque","île","arctique"],"🌕":["pleine lune","argent","ronde"],"🌠":["étoile filante","souhait","tracé"],"🌧️":["averse","rumeur","ruissellement"],"🎵":["chant","mélodie","tempo"],"🪞":["miroir","reflet","lueur"],"🪷":["lotus","étang","sérénité"],"💫":["étincelle","vertige","poussière d’étoile"]},ae=["sous","dans","sur","vers","près de","avec"],oe=["chante","tombe","respire","murmure","gronde","luit","s'éveille","s'endort"],ie=["doucement","lentement","encore","déjà","toujours"],le=["—","…",":"];function E(e){return e[Math.floor(Math.random()*e.length)]}function ce(e){const t=(e||"").trim().toLowerCase();return/^[aeiouyàâäéèêëîïôöùûüœh]/.test(t)}function ue(e){const t=(e||"").trim().toLowerCase();return/e$/.test(t)||/ée$/.test(t)||/ette$/.test(t)}function P(e){const t=(e||"").trim();if(t.length===0||/^(le|la|les|un|une|des|du|de la|de l’|de l'|l’|l')\s/i.test(t))return t;if(ce(t))return`l’${t}`;const r=ue(t);return`${E(r?["la","une","cette"]:["le","un","ce"])} ${t}`}function $(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function M(e,t){const r=e;switch(t){case 0:return $(P(r));case 1:return`${$(E(ae))} ${P(r)}`;case 2:return`${$(E(oe))} ${P(r)}`;case 3:return`${$(P(r))} ${E(ie)}`;default:return $(r)}}function k(e){const t=re[e];return Array.isArray(t)&&t.length>0?t:["silence","nuit","vent"]}function T(e=[],t=D){const r=Array.isArray(e)?e.slice(0,3):[];if(r.length<3)return[];const[h,c,d]=r,N=k(h),v=k(c),n=k(d),i=new Set;for(;i.size<Math.min(t,8);){const u=E(N),m=E(v),f=E(n),x=Math.floor(Math.random()*5);let l,w,S;if(x===0)l=M(u,0),w=M(m,1),S=M(f,2);else if(x===1)l=M(u,0),w=M(m,3),S=M(f,0);else if(x===2){const b=E(le);l=`${M(u,0)} ${b}`,w=M(m,2),S=M(f,0)}else x===3?(l=M(u,0),w=`Entre ${P(u)} et ${P(f)}`,S=M(f,0)):(l=$(u),w=$(m),S=$(f));const I=`${l}
${w}
${S}`;i.add(I)}return Array.from(i)}const de=400,me=36;function he(e,t,r){const[h,c]=o.useState(()=>new Array(e).fill(0).map(()=>({x:0,y:0}))),d=o.useRef(new Array(e).fill(0).map(()=>({vx:0,vy:0}))),N=o.useRef(new Array(e).fill(null).map(()=>ne())),v=o.useRef(null);return o.useEffect(()=>{const n=t/2-r,i=h.map(()=>{const u=Math.random()*Math.PI*2,m=Math.sqrt(Math.random())*n;return{x:Math.cos(u)*m,y:Math.sin(u)*m}});c(i),d.current=d.current.map(()=>({vx:Math.random()*.6-.3,vy:Math.random()*.6-.3}))},[e,t]),o.useEffect(()=>{const n=t/2-r,i=.995,u=.95;let m=performance.now();const f=()=>{const x=performance.now(),l=Math.min(33,x-m)/16.67;m=x,c(w=>w.map((I,b)=>{const y=d.current[b];y.vx+=(Math.random()-.5)*.01,y.vy+=(Math.random()-.5)*.01;let C=I.x+y.vx*l,a=I.y+y.vy*l;const g=Math.hypot(C,a);if(g>n){const A=C/g,j=a/g;C=A*n,a=j*n;const R=y.vx*A+y.vy*j;y.vx=(y.vx-2*R*A)*u,y.vy=(y.vy-2*R*j)*u}return y.vx*=i,y.vy*=i,{x:C,y:a}})),v.current=requestAnimationFrame(f)};return v.current=requestAnimationFrame(f),()=>cancelAnimationFrame(v.current)},[t]),{positions:h,controls:N.current}}function fe({emojis:e=q,selected:t,setSelected:r,maxSelected:h=5,size:c=de,emojiSize:d=me}){const N=o.useRef(null),{positions:v}=he(e.length,c,d),n=i=>{if(t.includes(i))r(t.filter(m=>m!==i));else{if(t.length>=h)return;r([...t,i])}};return s.jsx("div",{className:"relative mx-auto",style:{width:c,height:c},children:s.jsx("div",{ref:N,className:"w-full h-full rounded-full bg-white/70 backdrop-blur-sm shadow-inner shadow-blue-100 border border-white/60 overflow-hidden",children:e.map((i,u)=>{const m=t.includes(i),f=v[u]||{x:0,y:0},x=c/2,l={x:x+f.x-d/2,y:x+f.y-d/2};return s.jsx(p.button,{className:"absolute flex items-center justify-center select-none",style:{width:d,height:d},animate:{left:l.x,top:l.y,scale:m?1.35:1,filter:m?"drop-shadow(0 0 8px rgba(59,130,246,0.7))":"none"},transition:{type:"spring",stiffness:120,damping:16},onClick:()=>n(i),children:s.jsx("span",{className:`transition-colors ${m?"text-blue-600":"text-slate-700"}`,style:{fontSize:Math.round(d*.8)},children:i})},u)})})})}function xe({active:e=!1,count:t=25,continuous:r=!1}){const[h,c]=o.useState([]),d=o.useRef(0);o.useEffect(()=>{if(!e){c([]);return}const n=N(t);if(c(n),!r)return;const i=setInterval(()=>{c(u=>{const m=Date.now(),f=u.filter(w=>m-w.createdAt<8e3),x=3+Math.floor(Math.random()*3),l=N(x);return[...f,...l]})},800);return()=>clearInterval(i)},[e,t,r]);function N(n){return Array.from({length:n},()=>({id:`bubble-${d.current++}`,createdAt:Date.now(),x:50+(Math.random()-.5)*40,y:50+(Math.random()-.5)*40,size:6+Math.random()*28,delay:Math.random()*.5,duration:4+Math.random()*3,dx:(Math.random()-.5)*80,dy:-60-Math.random()*120,rotation:Math.random()*360,color:Math.random()>.7?"purple":Math.random()>.5?"cyan":"blue"}))}if(!e)return null;const v=n=>{switch(n){case"purple":return"radial-gradient(circle at 30% 30%, rgba(196, 181, 253, 0.9), rgba(147, 51, 234, 0.5))";case"cyan":return"radial-gradient(circle at 30% 30%, rgba(165, 243, 252, 0.9), rgba(34, 211, 238, 0.5))";default:return"radial-gradient(circle at 30% 30%, rgba(191, 219, 254, 0.9), rgba(96, 165, 250, 0.5))"}};return s.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden rounded-full",style:{zIndex:10},children:s.jsx(Q,{children:h.map(n=>s.jsx(p.div,{className:"absolute rounded-full",style:{left:`${n.x}%`,top:`${n.y}%`,width:n.size,height:n.size,background:v(n.color),boxShadow:`0 0 ${n.size*.5}px rgba(147, 197, 253, 0.7), inset -2px -2px 6px rgba(255, 255, 255, 0.6)`,border:"1px solid rgba(255, 255, 255, 0.3)"},initial:{opacity:0,scale:0,x:0,y:0,rotate:0},animate:{opacity:[0,.9,.7,0],scale:[0,1,1.3,.9],x:[0,n.dx*.3,n.dx],y:[0,n.dy*.5,n.dy],rotate:[n.rotation,n.rotation+180]},exit:{opacity:0,scale:0},transition:{duration:n.duration,delay:n.delay,ease:"easeOut"}},n.id))})})}const pe=q;function we(){const[e,t]=o.useState([]),[r,h]=o.useState(!1),[c,d]=o.useState(360),[N,v]=o.useState(36),[n,i]=o.useState(["","",""]),[u,m]=o.useState(""),[f,x]=o.useState([]),[l,w]=o.useState("select"),S=_(),I=o.useRef(null);o.useEffect(()=>{J();const a=G();a&&(t(Array.isArray(a.emojis)?a.emojis:[]),i(Array.isArray(a.lines)&&a.lines.length===3?a.lines:["","",""]));const g=()=>{const A=Math.max(320,Math.min(window.innerWidth,640)),j=Math.max(540,window.innerHeight),R=Math.round(A*.82),B=Math.round(Math.max(260,Math.min(j*.48,460))),O=Math.min(R,B),H=Math.max(28,Math.round(O*.085));d(O),v(H)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),o.useEffect(()=>{W({emojis:e,lines:n})},[e,n]),o.useEffect(()=>{if(l==="compose"){if(e.length<3){x([]);return}x(T(e.slice(0,3)))}},[l,e]);const b=e.length>=3&&e.length<=5,y=b?"Créer ma Suggestion Onirique":"Choisir 3–5 émojis";o.useEffect(()=>{!b&&l!=="select"&&w("select")},[b,l]),o.useEffect(()=>{l==="compose"&&setTimeout(()=>{const a=I.current||document.getElementById("compose-area");a==null||a.scrollIntoView({behavior:"smooth",block:"center"})},0)},[l]);const C=()=>{if(!b)return;const a=n.map(j=>j.trim());if(a.some(j=>j.length===0)){m("Complète les trois lignes avant de publier.");return}const g=Z()||{name:"Anonyme",id:null},A=a.join(`
`);X({emojis:e.slice(0,5),text:A,author:g.name,authorId:g.id}),K(),S("/community")};return s.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-midnight-900 to-midnight-800",children:[s.jsxs(p.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"p-6 flex items-center justify-between glass-strong border-b border-white/10",children:[s.jsxs("div",{className:"font-semibold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:"✨"}),s.jsx("span",{children:"Souffleur de Rêves"})]}),s.jsxs("div",{className:"px-3 py-1.5 rounded-full glass border border-white/20 text-sm font-medium text-white",children:[e.length,"/5 émojis"]})]}),s.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-8 px-4 py-8",children:[s.jsxs(p.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"relative w-full flex items-center justify-center",children:[s.jsx(xe,{active:b,count:20,continuous:!0}),s.jsx(fe,{emojis:pe,selected:e,setSelected:t,maxSelected:5,size:c,emojiSize:N}),s.jsx(p.button,{onClick:()=>h(!0),className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full flex items-center justify-center bg-gradient-to-br from-white to-slate-100 text-slate-900 shadow-glow-lg border-2 border-white/70 hover:scale-110 transition-transform duration-300",animate:{scale:[1,1.08,1],boxShadow:["0 0 20px rgba(59,130,246,0.25), 0 0 40px rgba(147,51,234,0.15)","0 0 40px rgba(59,130,246,0.45), 0 0 60px rgba(147,51,234,0.25)","0 0 20px rgba(59,130,246,0.25), 0 0 40px rgba(147,51,234,0.15)"]},transition:{duration:2.4,repeat:1/0,ease:"easeInOut"},"aria-label":"Open Panthéon",title:"Voir le Panthéon",children:s.jsx("span",{className:"text-3xl",children:"✨"})})]}),s.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"w-full max-w-sm",children:s.jsx(p.button,{disabled:!b,whileHover:b?{scale:1.02}:{},whileTap:b?{scale:.98}:{},className:`w-full h-14 rounded-2xl font-semibold transition-all duration-300 ${b?"bg-gradient-to-r from-midnight-400 to-midnight-500 text-white hover:shadow-aurora shadow-lg":"glass text-slate-400 cursor-not-allowed border border-white/10"}`,onClick:()=>w("compose"),children:y})}),l==="compose"&&b&&s.jsxs(p.div,{id:"compose-area",ref:I,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4},className:"w-full max-w-sm rounded-2xl bg-white text-slate-900 shadow-card-hover p-6 space-y-4",children:[s.jsx("div",{className:"text-3xl select-none mb-2 text-center",children:e.join(" ")}),f.length>0&&s.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},className:"rounded-xl border border-slate-200 p-4 bg-gradient-to-br from-slate-50 to-white",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:"💡 Inspiration"}),s.jsx(p.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>x(T(e.slice(0,3))),className:"text-xs px-3 py-1.5 rounded-lg border border-slate-300 bg-white text-slate-900 hover:bg-slate-50 font-medium shadow-sm",children:"↻ Refaire"})]}),s.jsx("ul",{className:"space-y-2 max-h-56 overflow-auto pr-1",children:f.map((a,g)=>s.jsxs(p.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:g*.1},className:"flex items-start gap-2 p-3 rounded-lg bg-white border border-slate-200 hover:border-slate-300 transition-colors",children:[s.jsx("pre",{className:"flex-1 whitespace-pre-wrap text-sm text-slate-800 leading-relaxed",children:a}),s.jsx(p.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i(a.split(`
`).slice(0,3)),className:"self-start text-xs px-3 py-1.5 rounded-lg bg-gradient-to-r from-emerald-600 to-emerald-500 text-white hover:from-emerald-700 hover:to-emerald-600 font-medium shadow-sm","aria-label":"Utiliser cette suggestion",children:"Utiliser"})]},g))})]}),[0,1,2].map(a=>s.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2+a*.1},className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Ligne ",a+1," ",s.jsxs("span",{className:"text-slate-400 font-normal",children:["(",a===1?"7":"5"," syllabes)"]})]}),s.jsx("textarea",{value:n[a],onChange:g=>i(n.map((A,j)=>j===a?g.target.value:A)),rows:2,className:"w-full rounded-xl border-2 border-slate-200 px-4 py-3 focus:outline-none focus:border-midnight-400 focus:ring-4 focus:ring-midnight-400/20 transition-all duration-300",placeholder:a===0?"Un rêve commence...":a===1?"L'émotion s'éveille...":"Le voyage continue..."})]},a)),u&&s.jsx(p.p,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:u}),s.jsx(p.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:C,className:"w-full h-14 rounded-xl bg-gradient-to-r from-emerald-600 to-emerald-500 text-white font-semibold hover:from-emerald-700 hover:to-emerald-600 shadow-lg hover:shadow-xl transition-all duration-300",children:"✨ Publier ma suggestion onirique"})]})]}),s.jsxs(p.footer,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"p-4 text-center text-xs text-slate-400 glass-strong border-t border-white/10",children:["Prototype – animations ",s.jsx("span",{className:"font-mono text-slate-300",children:"Framer Motion"}),", layout ",s.jsx("span",{className:"font-mono text-slate-300",children:"Tailwind"})]}),s.jsx(Y,{open:r,onClose:()=>h(!1)})]})}export{we as default};
