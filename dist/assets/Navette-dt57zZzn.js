import{r as c,j as e,m,B as k,C as S,s as w,D as E,e as T,u as $,g as q,E as A,k as M,F as B}from"./index-Dc6lTo75.js";import{B as F,E as I}from"./BubbleParticles-Bp6mmH_Z.js";import{A as v}from"./index-Br8V8rbl.js";import{S as O}from"./SelectionPanel-C30NmAx7.js";function R({currentStep:s=1,steps:t=[],onStepClick:i,className:f=""}){const[n,u]=c.useState(s);return e.jsxs("div",{className:`space-y-4 ${f}`,children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex items-center justify-between",children:t.map((l,h)=>{const o=h+1,x=o<s,a=o===s,r=o>s;return e.jsxs("div",{className:"flex-1 relative",children:[h>0&&e.jsx("div",{className:"absolute left-0 top-5 right-1/2 h-0.5 -translate-x-full",children:e.jsx("div",{className:`h-full transition-all duration-500 ${x||a?"bg-gradient-to-r from-emerald-500 to-emerald-400":"bg-slate-200"}`})}),e.jsxs(m.button,{onClick:()=>{u(o),i==null||i(o)},disabled:r,className:`relative z-10 flex flex-col items-center gap-2 w-full group ${r?"cursor-not-allowed":"cursor-pointer"}`,whileHover:r?{}:{scale:1.05},whileTap:r?{}:{scale:.98},children:[e.jsx(m.div,{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm shadow-lg transition-all duration-300 ${x?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white":a?"bg-gradient-to-br from-cyan-500 to-blue-500 text-white ring-4 ring-cyan-200":"bg-slate-200 text-slate-400"}`,animate:a?{boxShadow:["0 4px 6px rgba(6, 182, 212, 0.3)","0 8px 16px rgba(6, 182, 212, 0.5)","0 4px 6px rgba(6, 182, 212, 0.3)"]}:{},transition:{duration:2,repeat:1/0},children:x?"âœ“":o}),e.jsx("div",{className:`text-2xl transition-transform duration-300 ${a?"scale-110":""}`,children:l.icon}),e.jsx("div",{className:`text-xs font-medium text-center transition-colors duration-300 ${x||a?"text-slate-900":"text-slate-400"}`,children:l.title})]})]},l.id)})})}),e.jsx(v,{mode:"wait",children:e.jsx(m.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"rounded-2xl bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 p-6 shadow-lg",children:t[n-1]&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-3xl",children:t[n-1].icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-cyan-600 font-medium",children:["Ã‰tape ",n,"/",t.length]}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t[n-1].title})]})]}),e.jsx("p",{className:"text-slate-700 leading-relaxed mb-4",children:t[n-1].description}),t[n-1].tips&&e.jsxs("div",{className:"rounded-xl bg-white/60 border border-cyan-200 p-4",children:[e.jsx("div",{className:"text-sm font-medium text-cyan-700 mb-2",children:"ðŸ’¡ Astuce"}),e.jsx("p",{className:"text-sm text-slate-600",children:t[n-1].tips})]})]})},n)})]})}function C({value:s=[],onChange:t,placeholder:i="Ajouter des mots-clÃ©s",maxTags:f=6,className:n=""}){const[u,l]=c.useState(""),[h,o]=c.useState(!1),[x,a]=c.useState([]),r=Array.isArray(s)?s:[],b=r.length<f;c.useEffect(()=>{if(!u.trim()){a([]);return}a(k(u,6))},[u]);const g=d=>{if(!b)return;const p=S(d);p&&(r.includes(p)||(t==null||t([...r,p]),l(""),a([])))},j=d=>{t==null||t(r.filter(p=>p!==d))},y=d=>{d.key==="Enter"||d.key===","?(d.preventDefault(),g(u)):d.key==="Backspace"&&!u&&r.length&&j(r[r.length-1])};return e.jsxs("div",{className:`rounded-2xl bg-white text-slate-900 border border-slate-200 p-3 ${n}`,children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.map(d=>e.jsxs(m.span,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-full bg-gradient-to-r from-emerald-50 to-cyan-50 border border-emerald-200 text-emerald-700 text-sm",children:["#",d,e.jsx("button",{onClick:()=>j(d),className:"text-emerald-700/70 hover:text-emerald-900 ml-1",children:"Ã—"})]},d)),b&&e.jsxs("div",{className:"relative flex-1 min-w-[120px]",children:[e.jsx("input",{value:u,onChange:d=>l(d.target.value),onKeyDown:y,onFocus:()=>o(!0),onBlur:()=>setTimeout(()=>o(!1),150),placeholder:i,className:"w-full px-3 py-1.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),e.jsx(v,{children:h&&x.length>0&&e.jsx(m.ul,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},className:"absolute z-10 mt-1 left-0 right-0 rounded-xl bg-white border border-slate-200 shadow-lg overflow-hidden",children:x.map(d=>e.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-slate-50 cursor-pointer",onMouseDown:p=>p.preventDefault(),onClick:()=>g(d.label),children:["#",d.label]},d.id))})})]})]}),!b&&e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Limite de ",f," tags atteinte."]})]})}function N({emojis:s=[],size:t=120,className:i=""}){const f=Array.isArray(s)?s.slice(0,3):[],n=c.useMemo(()=>{const l=t/2-Math.max(18,Math.round(t*.12)),h=t/2,o=t/2;return[270,150,30].map(a=>{const r=a*Math.PI/180;return{x:h+l*Math.cos(r),y:o+l*Math.sin(r)}})},[t]),u=Math.max(18,Math.round(t*.22));return e.jsxs("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,className:i,children:[e.jsx("polygon",{points:n.map(l=>`${l.x},${l.y}`).join(" "),fill:"none",stroke:"#06b6d4",strokeWidth:Math.max(2,Math.round(t*.02)),strokeOpacity:.5}),n.map((l,h)=>e.jsxs("g",{children:[e.jsx("circle",{cx:l.x,cy:l.y,r:Math.max(10,Math.round(t*.06)),fill:"#10b98120",stroke:"#10b981",strokeWidth:1.5}),e.jsx("text",{x:l.x,y:l.y+u*.35,fontSize:u,textAnchor:"middle",children:f[h]||"â—‹"})]},h))]})}function D({item:s}){return e.jsx(m.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"rounded-2xl bg-white text-slate-900 shadow-card hover:shadow-card-hover p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{emojis:s.emojis,size:84}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm text-slate-500",children:["â€” ",s.author||"Anonyme"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(s.tags||[]).map(t=>e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200 text-xs",children:["#",t]},t))})]})]})})}function z({className:s="",refreshKey:t=0}){const[i,f]=c.useState([]);return c.useEffect(()=>{w(),f(E())},[t]),e.jsxs("div",{className:`space-y-3 ${s}`,children:[i.map(n=>e.jsx(D,{item:n},n.id)),i.length===0&&e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center text-slate-500 py-10",children:"Aucun onimoji pour le moment."})]})}function H({open:s,onClose:t,emojis:i=[],onContinue:f}){const n=c.useRef(null),u=c.useRef(null),l=c.useRef(null);c.useEffect(()=>{if(!s){const a=l.current;a&&typeof a.focus=="function"&&setTimeout(()=>a.focus(),0),document.body.style.overflow="";return}l.current=document.activeElement,document.body.style.overflow="hidden";const o=a=>{s&&a.key==="Escape"&&(a.preventDefault(),t==null||t())},x=setTimeout(()=>{var a,r;(r=(a=u.current)==null?void 0:a.focus)==null||r.call(a)},0);return window.addEventListener("keydown",o),()=>{clearTimeout(x),window.removeEventListener("keydown",o)}},[s,t]);const h=async()=>{const o=T(),x=`âœ¨ Ma bulle onirique du jour
${(i||[]).slice(0,3).join(" ")}
`,a={title:"Bulle onirique â€“ Cosmoji",text:x,url:o};try{if(navigator.share){await navigator.share(a);return}}catch{}try{await navigator.clipboard.writeText(`${x}
${o}`)}catch{}};return e.jsx(v,{children:s&&e.jsxs(m.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:t}),e.jsxs(m.div,{role:"dialog","aria-modal":"true","aria-labelledby":"cosmoji-bubble-title",className:"relative z-10 w-[92vw] max-w-xl rounded-2xl bg-white text-slate-900 shadow-2xl p-6 md:p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.97,opacity:0},transition:{type:"spring",stiffness:140,damping:16},ref:n,tabIndex:-1,children:[e.jsx("button",{onClick:t,className:"absolute right-4 top-4 h-9 w-9 rounded-full bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition flex items-center justify-center","aria-label":"Fermer",ref:u,children:"Ã—"}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-gradient-to-r from-cyan-100 to-blue-100 text-cyan-700 text-sm font-medium mb-3",children:"Bulle onirique"}),e.jsx("h2",{id:"cosmoji-bubble-title",className:"text-xl font-semibold",children:"Votre trio cosmique"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative w-72 h-72 md:w-96 md:h-96 rounded-full bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 shadow-inner overflow-hidden",children:[e.jsx(F,{active:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(N,{emojis:i,size:260})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(m.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:h,className:"flex-1 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 font-semibold shadow-lg hover:shadow-xl transition-all",children:"ðŸ“¤ Partager la bulle onirique"}),e.jsx(m.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:f,className:"flex-1 rounded-xl bg-gradient-to-r from-emerald-500 to-cyan-500 text-white px-6 py-3 font-semibold shadow-lg hover:shadow-xl transition-all",children:"âœ§ Continuer vers le Guide"})]})]})]})})}function V(){const[s,t]=c.useState([]),[i,f]=c.useState(null),[n,u]=c.useState([]),[l,h]=c.useState(0),[o,x]=c.useState(!1),a=$();c.useEffect(()=>{w(),f(q())},[]);const r=()=>{s.length===3&&x(!0)},b=()=>{s.length===3&&(M(s),x(!1),a("/guardian"))},g=()=>{if(!(!i||s.length!==3))try{B({emojis:s,tags:n,author:i.name,authorId:i.id}),u([]),h(y=>y+1)}catch{}};c.useEffect(()=>{i||a("/cosmoji")},[i,a]);const j=[{id:"select",icon:"âœ¨",title:"Choisir 3 Ã©mojis",description:"SÃ©lectionnez 3 Ã©mojis dans le hublot Cosmoji. Ils formeront la base de votre rÃªve.",tips:"Cliquez dans le cercle effervescent (hublot) pour choisir vos 3 symboles."},{id:"lune",icon:"ðŸŒ™",title:"CrÃ©er votre haÃ¯ku",description:"Votre trio d'Ã©mojis gÃ©nÃ©rera un haÃ¯ku unique inspirÃ© par la sagesse inuite et la poÃ©sie onirique.",tips:"Vous pourrez regÃ©nÃ©rer le texte autant de fois que vous le souhaitez jusqu'Ã  trouver celui qui vous parle."},{id:"guardian",icon:"âœ§",title:"Rencontrer le guide",description:"Un gardien onimoji inuit (Sila, Sedna, Nanook...) vous accueillera pour un rituel d'apaisement.",tips:"Le gardien est choisi en fonction des Ã©mojis que vous avez sÃ©lectionnÃ©s et de la lune en cours."}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-2xl glass-strong border border-white/20 shadow-card p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 text-8xl opacity-10",children:"ðŸš€"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"inline-block px-4 py-2 rounded-full bg-gradient-to-r from-aurora-blue/20 to-aurora-cyan/20 border border-white/10 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-white",children:"ðŸŒŒ Navette Cosmoniris"})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-3",children:"Hublot Cosmoji"}),e.jsxs("p",{className:"text-slate-300 text-sm leading-relaxed mb-4",children:["ðŸŒ™ Bienvenue Ã  bord, ",(i==null?void 0:i.name)||"Voyageur"," ! Le voyage Inuit se dÃ©roule en 12 lunes. Ã€ chaque lune, vous suivrez ce parcours en 3 Ã©tapes pour enrichir votre univers onirique."]})]})]}),e.jsx(m.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(R,{currentStep:1,steps:j})}),e.jsxs(m.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"rounded-2xl bg-white text-slate-900 shadow-card-hover p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(I,{emojis:A(),selected:s,setSelected:t,maxSelected:3,size:380,emojiSize:34})})}),e.jsxs("div",{className:"flex flex-col gap-4 pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-600",children:s.length===0?e.jsx("span",{className:"text-slate-400 italic",children:"Aucun Ã©moji sÃ©lectionnÃ©"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:"Votre sÃ©lection :"})," ",e.jsx("span",{className:"font-mono text-2xl ml-2",children:s.join(" ")}),e.jsxs("span",{className:"ml-2 text-xs text-slate-500",children:["(",s.length,"/3)"]})]})}),e.jsx(C,{value:n,onChange:u,placeholder:"Ajouter vos mots-clÃ©s (optionnel)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(m.button,{whileHover:s.length===3?{scale:1.02}:{},whileTap:s.length===3?{scale:.98}:{},onClick:g,disabled:s.length!==3,className:`flex-1 rounded-xl px-6 py-3 font-semibold transition-all duration-300 ${s.length===3?"bg-gradient-to-r from-emerald-600 to-emerald-500 text-white shadow-lg":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:"âœ¨ Ã‰mettre mon onimoji"}),e.jsx(m.button,{whileHover:s.length===3?{scale:1.02}:{},whileTap:s.length===3?{scale:.98}:{},onClick:r,disabled:s.length!==3,className:`flex-1 rounded-xl px-6 py-3 font-semibold transition-all duration-300 ${s.length===3?"bg-gradient-to-r from-midnight-400 to-midnight-500 text-white shadow-lg":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:"âœ§ GÃ©nÃ©rer l'Ã©nergie onirique"})]})]})]}),e.jsx(m.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},children:e.jsx(O,{selected:s,maxSelection:3,onClear:()=>t([])})}),e.jsxs(m.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"rounded-2xl glass-strong border border-white/20 p-6",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Flux des onimojis"}),e.jsx(z,{refreshKey:l})]}),e.jsx(H,{open:o,onClose:()=>x(!1),emojis:s,onContinue:b})]})}export{V as default};
